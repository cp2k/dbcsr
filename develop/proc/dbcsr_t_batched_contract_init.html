<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="">
    <meta name="author" content="DBCSR Authors" >
    <link rel="icon" href="../favicon.png">

    <title>dbcsr_t_batched_contract_init &ndash; DBCSR</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">DBCSR <small>2.2.0-83-gc17b0b44ba</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>Guide</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>dbcsr_t_batched_contract_init
      <small>Subroutine</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.1% of total for procedures.">68 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/dbcsr_tensor.F"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/dbcsr_tensor.f.html'>dbcsr_tensor.F</a></li>
     <li><a href='../module/dbcsr_tensor.html'>dbcsr_tensor</a></li>
     <li class="active">dbcsr_t_batched_contract_init</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars-0">Variables</a></h3></div>
  <div id="vars-0" class="panel-collapse collapse">
    <div class="list-group">
      <a class="list-group-item" href="../proc/dbcsr_t_batched_contract_init.html#variable-tdims">tdims</a>
      <a class="list-group-item" href="../proc/dbcsr_t_batched_contract_init.html#variable-batch_range_prv_1">batch_range_prv_1</a>
      <a class="list-group-item" href="../proc/dbcsr_t_batched_contract_init.html#variable-batch_range_prv_2">batch_range_prv_2</a>
      <a class="list-group-item" href="../proc/dbcsr_t_batched_contract_init.html#variable-batch_range_prv_3">batch_range_prv_3</a>
      <a class="list-group-item" href="../proc/dbcsr_t_batched_contract_init.html#variable-batch_range_prv_4">batch_range_prv_4</a>
      <a class="list-group-item" href="../proc/dbcsr_t_batched_contract_init.html#variable-static_range">static_range</a>
    </div>
  </div>
</div>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public subroutine dbcsr_t_batched_contract_init(tensor, batch_range_1, batch_range_2, batch_range_3, batch_range_4)</h2>
    

    <p>Initialize batched contraction for this tensor.</p>
<p>Explanation: A batched contraction is a contraction performed in several consecutive steps by
specification of bounds in dbcsr_t_contract. This can be used to reduce memory by a large factor.
The routines dbcsr_t_batched_contract_init and dbcsr_t_batched_contract_finalize should be
called to define the scope of a batched contraction as this enables important optimizations
(adapting communication scheme to batches and adapting process grid to multiplication algorithm).
The routines dbcsr_t_batched_contract_init and dbcsr_t_batched_contract_finalize must be called
before the first and after the last contraction step on all 3 tensors.</p>
<p>Requirements:
- the tensors are in a compatible matrix layout (see documentation of <code>dbcsr_t_contract</code>, note 2 &amp; 3).
  If they are not, process grid optimizations are disabled and a warning is issued.
- within the scope of a batched contraction, it is not allowed to access or change tensor data
  except by calling the routines dbcsr_t_contract &amp; dbcsr_t_copy.
- the bounds affecting indices of the smallest tensor must not change in the course of a batched
  contraction (todo: get rid of this requirement).</p>
<p>Side effects:
- the parallel layout (process grid and distribution) of all tensors may change. In order to
  disable the process grid optimization including this side effect, call this routine only on the
  smallest of the 3 tensors.</p>
<p></p><div class="alert alert-info" role="alert"><h4>Note</h4><p>Note 1: for an example of batched contraction see <code>examples/dbcsr_tensor_example.F</code>.
(todo: the example is outdated and should be updated).</p>
<p>Note 2: it is meaningful to use this feature if the contraction consists of one batch only
but if multiple contractions involving the same 3 tensors are performed
(batched_contract_init and batched_contract_finalize must then be called before/after each
contraction call). The process grid is then optimized after the first contraction
and future contraction may profit from this optimization.
</p></div>
<p>

    <h3>Arguments</h3>
      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" id="variable-tensor~138"></span>type(<a href='../type/dbcsr_t_type.html'>dbcsr_t_type</a>),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>tensor</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-batch_range_1"></span>integer,</td>
<td>intent(in),</td>
  <td>optional</td>  <td>DIMENSION(:)</td><td>::</td>
  <td><strong>batch_range_1</strong></td><td><p>For internal load balancing optimizations, optionally specify the index ranges of
batched contraction.
batch_range_i refers to the ith tensor dimension and contains all block indices starting
a new range. The size should be the number of ranges plus one, the last element being the
block index plus one of the last block in the last range.</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-batch_range_2"></span>integer,</td>
<td>intent(in),</td>
  <td>optional</td>  <td>DIMENSION(:)</td><td>::</td>
  <td><strong>batch_range_2</strong></td><td><p>For internal load balancing optimizations, optionally specify the index ranges of
batched contraction.
batch_range_i refers to the ith tensor dimension and contains all block indices starting
a new range. The size should be the number of ranges plus one, the last element being the
block index plus one of the last block in the last range.</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-batch_range_3"></span>integer,</td>
<td>intent(in),</td>
  <td>optional</td>  <td>DIMENSION(:)</td><td>::</td>
  <td><strong>batch_range_3</strong></td><td><p>For internal load balancing optimizations, optionally specify the index ranges of
batched contraction.
batch_range_i refers to the ith tensor dimension and contains all block indices starting
a new range. The size should be the number of ranges plus one, the last element being the
block index plus one of the last block in the last range.</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-batch_range_4"></span>integer,</td>
<td>intent(in),</td>
  <td>optional</td>  <td>DIMENSION(:)</td><td>::</td>
  <td><strong>batch_range_4</strong></td><td><p>For internal load balancing optimizations, optionally specify the index ranges of
batched contraction.
batch_range_i refers to the ith tensor dimension and contains all block indices starting
a new range. The size should be the number of ranges plus one, the last element being the
block index plus one of the last block in the last range.</p></td>
</tr>
</tbody>
</table>

    <br>

    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars-1">Variables</a></h3></div>
  <div id="vars-1" class="panel-collapse collapse">
    <div class="list-group">
      <a class="list-group-item" href="../proc/dbcsr_t_batched_contract_init.html#variable-tdims">tdims</a>
      <a class="list-group-item" href="../proc/dbcsr_t_batched_contract_init.html#variable-batch_range_prv_1">batch_range_prv_1</a>
      <a class="list-group-item" href="../proc/dbcsr_t_batched_contract_init.html#variable-batch_range_prv_2">batch_range_prv_2</a>
      <a class="list-group-item" href="../proc/dbcsr_t_batched_contract_init.html#variable-batch_range_prv_3">batch_range_prv_3</a>
      <a class="list-group-item" href="../proc/dbcsr_t_batched_contract_init.html#variable-batch_range_prv_4">batch_range_prv_4</a>
      <a class="list-group-item" href="../proc/dbcsr_t_batched_contract_init.html#variable-static_range">static_range</a>
    </div>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">


    <section>    
      <h2>Variables</h2>
    <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Visibility</th><th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" id="variable-tdims"></span>integer,</td>
<td>private,</td>  <td>DIMENSION(ndims_tensor(tensor))</td><td>::</td>
  <td><strong>tdims</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-batch_range_prv_1"></span>integer,</td>
<td>private,</td>  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>batch_range_prv_1</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-batch_range_prv_2"></span>integer,</td>
<td>private,</td>  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>batch_range_prv_2</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-batch_range_prv_3"></span>integer,</td>
<td>private,</td>  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>batch_range_prv_3</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-batch_range_prv_4"></span>integer,</td>
<td>private,</td>  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>batch_range_prv_4</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-static_range"></span>logical,</td>
<td>private</td>  <td></td><td>::</td>
  <td><strong>static_range</strong></td><td></td><td></td><td></td>
</tr>
</tbody>
</table>

    </section>
    <br>
    
    

    
    


    
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>DBCSR was developed by DBCSR Authors<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
  </body>
</html>